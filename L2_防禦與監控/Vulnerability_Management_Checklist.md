# 弱點管理與漏洞掃描待辦清單
# Vulnerability Management & Nessus Scanning Checklist

> **文件版本 Document Version**: v1.0  
> **最後更新 Last Updated**: 2026-02-12  
> **培訓時數 Training Hours**: 12小時 (P2改善級，4月初)  
> **優先級 Priority**: 🟡 P2 改善生存級  
> **受眾 Audience**: IT基礎設施工程師、系統管理員、安全人員、漏洞管理員  
> **前置條件 Prerequisites**: 理解CVSS評分、基本網路安全概念、補丁管理基礎  
> **當前狀況 Current Status**: Nessus已部署但無定期掃描計畫 ⚠️  
> **目標 Objectives**: 建立月度漏洞掃描流程、CVSS優先級化、補丁修復追蹤、ISO 27001 A12.6.1合規

---

## 📋 課程大綱 Course Outline

### 模組1：漏洞管理框架與CVSS評分 (3小時)
**Vulnerability Management Framework & CVSS Scoring**

### 模組2：Nessus掃描部署與配置 (3小時)
**Nessus Deployment & Scanning Configuration**

### 模組3：掃描結果分析與優先級化 (3小時)
**Scan Results Analysis & Prioritization**

### 模組4：補丁管理與修復流程 (3小時)
**Patch Management & Remediation Workflow**

---

## 第一天：漏洞管理基礎
## Day 1: Vulnerability Management Fundamentals (3 hours)

### 模組1.1：漏洞管理框架 (2小時)

```
漏洞管理生命週期 (Vulnerability Management Lifecycle)

┌──────────────────────────────────────┐
│  漏洞管理五階段流程                  │
├──────────────────────────────────────┤
│                                      │
│ 階段1: 資產探測 (Asset Discovery)  │
│ ├─ 發現網路上所有IP地址            │
│ ├─ 識別所有伺服器、工作站、設備   │
│ ├─ 建立資產清冊                    │
│ └─ 目標: 無遺漏的設備清單           │
│          ↓ (週期: 月度)             │
│ 階段2: 漏洞掃描 (Vulnerability Scan)│
│ ├─ 使用Nessus進行自動掃描          │
│ ├─ 檢測已知漏洞 (CVE database)    │
│ ├─ 檢測配置錯誤 (weak protocols)  │
│ ├─ 檢測缺失補丁 (missing patches)  │
│ └─ 目標: 識別所有漏洞               │
│          ↓ (週期: 月度或雙週)      │
│ 階段3: 優先級化 (Prioritization)  │
│ ├─ CVSS評分                        │
│ ├─ 業務影響評估                    │
│ ├─ 可利用程度分析                  │
│ ├─ 資產重要性考慮                  │
│ └─ 目標: 優先級清單 (P0-P3)        │
│          ↓ (實時)                   │
│ 階段4: 修復 (Remediation)          │
│ ├─ 補丁安裝 (patching)            │
│ ├─ 配置修正 (configuration change) │
│ ├─ 版本升級 (software upgrade)     │
│ ├─ 系統加固 (hardening)           │
│ ├─ 臨時緩解 (temporary mitigation) │
│ └─ 目標: 漏洞消除或降級            │
│          ↓ (週期: 根據優先級)      │
│ 階段5: 驗證 (Verification)        │
│ ├─ 重新掃描驗證修復                │
│ ├─ 確認漏洞已消除                  │
│ ├─ 性能影響驗證                    │
│ ├─ 回歸測試                        │
│ └─ 目標: 修復有效性確認            │
│          ↓                          │
│     回到階段1（持續循環）           │
│                                      │
└──────────────────────────────────────┘

當前狀況分析 (Current State):

✅ 已實施:
├─ Nessus Professional授權 (已購買)
├─ 掃描伺服器部署 (IP 10.0.1.50)
├─ 初始漏洞掃描 (2026-01 執行過)
└─ 部份漏洞補丁

❌ 缺失:
├─ 定期掃描計畫 (無固定週期)
├─ 漏洞優先級化流程 (無優先級)
├─ 修復跟蹤機制 (無記錄)
├─ 掃描報告自動化 (手動彙整)
├─ 漏洞驗證程序 (無驗證)
├─ 員工培訓文檔 (無SOP)
└─ ISO A12.6.1稽核證據 (缺乏記錄)

目標狀況 (Desired State - 本課程結束):

✅ 將實現:
├─ 月度自動掃描計畫
├─ CVSS優先級化規則自動應用
├─ 漏洞修復追蹤與報告
├─ 補丁安裝驗證流程
├─ 每週漏洞狀態報告
├─ ISO 27001 A12.6.1完整證據
└─ 漏洞響應時間SLA定義
```

---

### 模組1.2：CVSS評分與優先級化 (1小時)

```
CVSS (Common Vulnerability Scoring System) 3.1標準

CVSS分數範圍與嚴重程度:

┌──────────────────────────────────────┐
│ 分數  │ 嚴重級別 │ 回應時間 │ 顏色   │
├──────────────────────────────────────┤
│ 9-10 │ 致命    │ <24小時 │ 🔴紅   │
│      │ CRITICAL│         │       │
├──────────────────────────────────────┤
│ 7-8.9│ 高      │ <7天   │ 🟠橙   │
│      │ HIGH    │         │       │
├──────────────────────────────────────┤
│ 4-6.9│ 中      │ <30天  │ 🟡黃   │
│      │ MEDIUM  │         │       │
├──────────────────────────────────────┤
│ 0.1-3.9│低     │ <60天  │ 🟢綠   │
│      │ LOW     │         │       │
└──────────────────────────────────────┘

CVSS評分計算因素:

1️⃣ 基礎分數 (Base Score) - 漏洞本身特性

  攻擊向量 (Attack Vector):
  ├─ 網路 (Network): 3.9 (可遠端利用 - 最危險)
  ├─ 相鄰 (Adjacent): 2.9 (需本地網路)
  ├─ 本地 (Local): 1.9 (需本地登入)
  └─ 物理 (Physical): 0.2 (需物理訪問)

  攻擊複雜度 (Attack Complexity):
  ├─ 低 (Low): 1.77 (容易利用)
  └─ 高 (High): 1.37 (困難利用)

  所需權限 (Privileges Required):
  ├─ 無 (None): 2.86 (無需權限 - 最危險)
  ├─ 低 (Low): 2.62 (低權限用戶)
  └─ 高 (High): 0.62 (管理員權限)

  用戶交互 (User Interaction):
  ├─ 無 (None): 2.62 (自動利用)
  └─ 必需 (Required): 1.46 (需用戶點擊)

  影響範圍 (Scope):
  ├─ 變更 (Changed): 1.52 (影響其他組件)
  └─ 未變更 (Unchanged): 1.0 (僅影響自身)

  機密性影響 (Confidentiality Impact):
  ├─ 高: 損害完整機密性 (資料外洩)
  ├─ 低: 部分機密性損害
  └─ 無: 無機密性損害

  完整性影響 (Integrity Impact):
  ├─ 高: 完全控制修改 (資料竄改)
  ├─ 低: 部分修改可能
  └─ 無: 無完整性損害

  可用性影響 (Availability Impact):
  ├─ 高: 完全拒絕服務 (系統停機)
  ├─ 低: 部分可用性喪失
  └─ 無: 可用性不受影響

2️⃣ 時間分數 (Temporal Score) - 漏洞現狀

  利用成熟度 (Exploit Maturity):
  ├─ 未被證明: 0.91 (只有理論)
  ├─ 非官方應用: 0.94 (民間POC)
  ├─ 官方POC: 0.97 (公開POC)
  └─ 功能性利用: 1.0 (野生利用存在)

  修復狀態 (Remediation Level):
  ├─ 不可用: 1.0 (無補丁)
  ├─ 臨時修復: 0.97 (臨時解決)
  ├─ 官方修復: 0.96 (官方補丁可用)
  └─ 完全修復: 0.95 (補丁已驗證)

  信心等級 (Confidence Level):
  ├─ 不確定: 0.92 (理論)
  ├─ 合理: 0.96 (多個來源)
  └─ 確認: 1.0 (官方確認)

本公司優先級化規則:

┌────────────────────────────────────┐
│ 漏洞優先級決策樹                    │
├────────────────────────────────────┤
│                                    │
│ CVSS ≥ 9.0 ?                     │
│ ├─ 是 → P0 (致命) 🔴             │
│ │   └─ 立即修復 (<24小時)        │
│ │   └─ 升級為緊急                │
│ │   └─ 可能導致系統停機          │
│ │   └─ 例: RCE漏洞, SQL注入      │
│ │                                │
│ ├─ 否 → CVSS ≥ 7.0 ?             │
│ │   ├─ 是 → P1 (高) 🟠           │
│ │   │   └─ 7天內修復              │
│ │   │   └─ 可能導致數據洩露      │
│ │   │   └─ 例: 認證繞過          │
│ │   │                             │
│ │   └─ 否 → CVSS ≥ 4.0 ?         │
│ │       ├─ 是 → P2 (中) 🟡      │
│ │       │   └─ 30天內修復         │
│ │       │   └─ 配置錯誤           │
│ │       │                         │
│ │       └─ 否 → P3 (低) 🟢       │
│ │           └─ 60天內修復         │
│ │           └─ 低風險漏洞         │
│                                    │
└────────────────────────────────────┘

環境因素調整:

基礎規則可根據以下因素調整優先級:

提高優先級 (升級一級):
├─ 如果漏洞影響 P0系統 (AD, SQL)
├─ 如果漏洞已有公開POC
├─ 如果漏洞正被主動利用 (0-day)
└─ 如果影響敏感資料

降低優先級 (降級一級):
├─ 如果系統已有彌補措施 (防火牆隔離)
├─ 如果系統準備廢除 (<3個月)
├─ 如果漏洞影響非生產環境
└─ 如果修復會導致業務中斷

例子:

漏洞1: SQL Server 2019 CVE-2024-5678
├─ CVSS: 8.8 (基礎)
├─ 類型: 認證繞過 (可直接利用)
├─ 影響: SQL Always On副本損壞
├─ 基礎優先級: P1 (CVSS 7-8.9)
├─ 環境因素: 漏洞影響P0系統 (SQL)
├─ 最終優先級: P0 ⬆️ (升級)
└─ 修復期限: <24小時

漏洞2: Windows 10 KB1234567
├─ CVSS: 5.5 (基礎)
├─ 類型: 本地權限提升
├─ 影響: 開發機器
├─ 基礎優先級: P2 (CVSS 4-6.9)
├─ 環境因素: 開發環境,非生產
├─ 最終優先級: P3 ⬇️ (降級)
└─ 修復期限: <60天
```

---

## 第二天：Nessus掃描操作
## Day 2: Nessus Scanning Operations (3 hours)

### 模組2.1：Nessus掃描計畫與執行 (2小時)

```
Nessus Professional 掃描部署

本公司環境配置:

Nessus伺服器:
├─ IP地址: 10.0.1.50
├─ 版本: Nessus 10.5.x
├─ 掃描能力: 65,536個並發掃描
├─ 授權: Professional (16 IP掃描)
└─ 許可狀態: 有效至2027-02-28

掃描範圍 (Scanning Scope):

掃描段1: 生產核心系統 (Critical Production)
├─ 網段: 10.0.0.0/24 (AD, SQL, VPN)
├─ 頻率: 月度 (每月1次)
├─ 時間: 週日 03:00-05:00 (停機窗口)
├─ 掃描類型: 認證掃描 (使用admin帳號)
└─ 預期掃描時間: 2小時

掃描段2: 重要應用系統 (Important Applications)
├─ 網段: 10.0.1.0/24 (應用伺服器)
├─ 頻率: 雙週 (每兩週1次)
├─ 時間: 週一 02:00-03:00
├─ 掃描類型: 無認證掃描 (網路層)
└─ 預期掃描時間: 1小時

掃描段3: 開發測試系統 (Dev/Test)
├─ 網段: 10.0.2.0/24 (開發機)
├─ 頻率: 月度 (可選)
├─ 時間: 週三 23:00
├─ 掃描類型: 完整掃描
└─ 預期掃描時間: 1.5小時

掃描段4: 外部邊界 (External Boundary)
├─ 目標: 公司網站, 遠端存取IP
├─ 頻率: 月度
├─ 時間: 週五 22:00
├─ 掃描類型: 非侵入式掃描
└─ 預期掃描時間: 0.5小時

月度掃描日程表:

┌─────────────────────────────────┐
│ 掃描計畫 (Monthly Schedule)      │
├─────────────────────────────────┤
│ 日期 │ 時間   │ 範圍      │ 類型 │
├─────────────────────────────────┤
│ 1月1 │ 03:00 │ 核心系統  │ 認證 │
│ 1月8 │ 02:00 │ 應用系統  │ 無認│
│ 1月15│ 23:00 │ 開發系統  │ 完整 │
│ 1月22│ 02:00 │ 應用系統  │ 無認│
│ 1月29│ 22:00 │ 外部邊界  │ 非侵│
└─────────────────────────────────┘

Nessus掃描執行步驟:

Step 1: 登入Nessus Console
└─ URL: https://10.0.1.50:8834
└─ 帳號: admin / [VAULT密碼]
└─ 驗證: 登入成功 ✓

Step 2: 選擇掃描範本
┌──────────────────────────────────┐
│ 可用掃描範本:                     │
├──────────────────────────────────┤
│                                  │
│ 1. Basic Network Scan             │
│    └─ 適用: 無認證掃描, 快速    │
│    └─ 時間: 0.5-1小時            │
│    └─ 用途: 初始探測              │
│                                  │
│ 2. Credentialed Patch Audit      │
│    └─ 適用: 有admin認證          │
│    └─ 時間: 1-2小時              │
│    └─ 用途: 補丁檢查              │
│                                  │
│ 3. Web Application Scan          │
│    └─ 適用: 網頁應用掃描         │
│    └─ 時間: 1-3小時              │
│    └─ 用途: 應用漏洞              │
│                                  │
│ 4. Database Assessment           │
│    └─ 適用: SQL Server/Oracle     │
│    └─ 時間: 1小時                │
│    └─ 用途: 資料庫安全            │
│                                  │
│ (本公司使用: #2 Credentialed)    │
│                                  │
└──────────────────────────────────┘

Step 3: 配置掃描參數
├─ 掃描名稱: "2026-02-Monthly-Production"
├─ 掃描目標: 10.0.0.0/24
├─ 掃描範本: Credentialed Patch Audit
├─ 認證設置:
│   ├─ Windows認證 (本地管理員)
│   ├─ 帳號: COMPANY\scan_admin
│   ├─ 密碼: [VAULT儲存]
│   └─ 網域: COMPANY.LOCAL
├─ 掃描時間表:
│   ├─ 開始: 2026-02-01 03:00
│   ├─ 週期: 每月1次
│   └─ 時長限制: 3小時 (強制停止)
├─ 通知設置:
│   ├─ 掃描完成→電子郵件通知
│   ├─ 收件人: security@company.com
│   └─ 發現>5個P0漏洞→立即通知CISO
└─ 保存: [Save as Template]

Step 4: 啟動掃描
└─ 按 [Launch] 開始掃描
└─ 監控進度:
   ├─ 已掃描主機: 12/16
   ├─ 進度: 75%
   ├─ 耗時: 1.5小時 / 預計2小時
   └─ 狀態: 執行中

Step 5: 即時監控
┌──────────────────────────────┐
│ 掃描進度監控                  │
├──────────────────────────────┤
│ 掃描狀態: 進行中              │
│ 已掃描資源: 12台伺服器        │
│ 目標資源: 16台伺服器          │
│ 進度: 75%                     │
│ 耗時: 1h 30m                  │
│ 預計完成: 14:30               │
│ 發現漏洞: 156個               │
│   ├─ P0 (9-10): 2個           │
│   ├─ P1 (7-8.9): 12個         │
│   ├─ P2 (4-6.9): 45個         │
│   └─ P3 (<4): 97個            │
│ 狀態: 一切正常 ✓              │
└──────────────────────────────┘

Step 6: 掃描完成與報告生成
└─ 掃描耗時: 1小時 58分
└─ 完成時間: 2026-02-01 04:58
└─ 總漏洞發現: 156個
└─ 自動報告: PDF已郵件送達
└─ Nessus記錄: 完整保存
```

---

### 模組2.2：掃描故障排除 (1小時)

```
常見掃描問題與解決方案

問題1: 掃描逾時 (Scan Timeout)
├─ 症狀: 掃描超過預期時間仍未完成
├─ 原因:
│   ├─ 網路連接慢 (>100ms延遲)
│   ├─ 目標系統性能差 (高CPU/記憶體)
│   ├─ 掃描範圍過大 (>256個IP)
│   └─ Nessus伺服器資源不足
├─ 解決方案:
│   ├─ 減少掃描目標 (分批掃描)
│   ├─ 使用更快速的掃描範本
│   ├─ 增加超時時間設置
│   └─ 在低負載時段執行
└─ 預防:
   ├─ 預留充足的掃描窗口 (預期時間×1.5)
   └─ 監控Nessus伺服器資源

問題2: 認證失敗 (Authentication Failed)
├─ 症狀: "Unable to authenticate" 錯誤
├─ 原因:
│   ├─ 帳號密碼錯誤
│   ├─ 帳號被鎖定 (嘗試多次失敗)
│   ├─ 帳號權限不足
│   ├─ 網路隔離 (防火牆阻擋)
│   └─ Windows防火牆阻止
├─ 解決方案:
│   ├─ 驗證帳號密碼 (在目標系統直接測試)
│   ├─ 解鎖被鎖定帳號
│   ├─ 確保帳號為本地管理員
│   ├─ 驗證Nessus→目標的網路連接
│   │   └─ 指令: ping <目標>, telnet <IP> 445
│   ├─ 開啟防火牆 (WinRM埠)
│   │   └─ 指令: netsh firewall set service RemoteAdmin enable
│   └─ 重新執行掃描
└─ 預防:
   ├─ 測試認證帳號的連接性
   └─ 在試驗掃描驗證認證

問題3: 漏洞檢測不完整 (Incomplete Detection)
├─ 症狀: 已知補丁遺漏未被檢測
├─ 原因:
│   ├─ Nessus外掛過舊 (未更新)
│   ├─ 無認證掃描 (無法深度檢查)
│   ├─ 掃描未啟用特定檢查
│   └─ 目標系統隱藏版本號
├─ 解決方案:
│   ├─ 更新Nessus外掛 (Settings → Updates)
│   ├─ 使用有認證掃描 (啟用Windows登入)
│   ├─ 啟用更多檢查項 (在掃描設置中)
│   └─ 手動驗證已知漏洞
├─ 驗證步驟:
│   ├─ 檢查Windows補丁: Get-HotFix | Sort-Object -Property InstalledOn
│   ├─ 檢查應用版本: 例如SQL Server SELECT @@VERSION
│   └─ 與Nessus結果比對
└─ 預防:
   ├─ 保持Nessus外掛最新 (每週自動更新)
   └─ 定期使用有認證掃描

問題4: 掃描報告缺失 (Missing Report)
├─ 症狀: 掃描完成但報告未生成
├─ 原因:
│   ├─ 報告生成失敗
│   ├─ 磁碟空間不足
│   ├─ 權限問題
│   └─ Nessus服務異常
├─ 解決方案:
│   ├─ 檢查Nessus磁碟空間: df -h /opt/nessus
│   ├─ 清理舊報告檔案
│   ├─ 檢查Nessus服務: systemctl status nessusd
│   ├─ 手動生成報告: 在Nessus UI重新生成
│   └─ 重啟Nessus服務 (最後手段)
└─ 預防:
   ├─ 監視Nessus磁碟使用
   └─ 定期清理舊報告
```

---

## 第三天：漏洞優先級與修復
## Day 3: Prioritization & Remediation (3 hours)

### 模組3.1：漏洞優先級化與追蹤 (2小時)

```
漏洞追蹤與修復流程

掃描報告分析:

2026-02月月度掃描報告:

┌──────────────────────────────────┐
│ 漏洞統計 (Vulnerability Summary) │
├──────────────────────────────────┤
│                                  │
│ 🔴 P0 (致命) 🔴                 │
│ ├─ 數量: 3個                    │
│ ├─ 例: CVE-2024-1234 RCE漏洞   │
│ │   (SQL Server遠端程式碼執行)  │
│ ├─ 影響: SQLPROD伺服器          │
│ ├─ 修復期限: <24小時            │
│ └─ 狀態: 已分配修復             │
│                                  │
│ 🟠 P1 (高) 🟠                   │
│ ├─ 數量: 18個                   │
│ ├─ 例: 缺失Windows補丁 KB123456 │
│ │   (認證繞過)                   │
│ ├─ 影響: 12台應用伺服器         │
│ ├─ 修復期限: <7天                │
│ └─ 狀態: 已分配修復             │
│                                  │
│ 🟡 P2 (中) 🟡                   │
│ ├─ 數量: 52個                   │
│ ├─ 例: 配置錯誤 (弱加密)       │
│ ├─ 影響: 多個系統                │
│ ├─ 修復期限: <30天               │
│ └─ 狀態: 已分配修復             │
│                                  │
│ 🟢 P3 (低) 🟢                   │
│ ├─ 數量: 83個                   │
│ ├─ 例: 資訊洩露                  │
│ ├─ 影響: 邊界系統                │
│ ├─ 修復期限: <60天               │
│ └─ 狀態: 記錄備查               │
│                                  │
│ 總計: 156個漏洞                 │
│                                  │
└──────────────────────────────────┘

漏洞追蹤表 (Vulnerability Tracking):

┌────────────────────────────────────────┐
│ 漏洞ID │ 描述      │ 系統      │ 優先級 │
├────────────────────────────────────────┤
│ VUL-01 │ RCE       │ SQLPROD   │ P0    │
│        │ CVE-..    │           │       │
│        │ CVSS 9.8  │           │       │
│        │ 狀態: 待修復          │       │
│        │ 期限: 2026-02-02      │       │
├────────────────────────────────────────┤
│ VUL-02 │ 認證繞過  │ AD-DC     │ P1    │
│        │ KB123456  │           │       │
│        │ CVSS 7.5  │           │       │
│        │ 狀態: 已規劃補丁      │       │
│        │ 期限: 2026-02-08      │       │
├────────────────────────────────────────┤
│ VUL-03 │ 弱加密    │ WebApp1   │ P2    │
│        │ TLS 1.0   │           │       │
│        │ CVSS 5.3  │           │       │
│        │ 狀態: 規劃升級        │       │
│        │ 期限: 2026-03-02      │       │
└────────────────────────────────────────┘

修復優先級決策:

P0漏洞修復流程 (24小時內):
1. 檢測到 → 2分鐘內升級CISO
2. CISO評估 → 立即決策
3. 選擇修復方案:
   ├─ A. 打補丁 (理想)
   ├─ B. 升級軟體
   ├─ C. 隔離系統 (臨時)
   └─ D. 多重防護 (並行)
4. 立即實施 (不等待維護窗口)
5. 驗證修復 → 重新掃描
6. 文檔與報告

P1漏洞修復流程 (7天內):
1. 檢測到 → 24小時內升級IT部長
2. 制定修復計畫 (1-2天)
3. 規劃維護窗口 (3-5天內)
4. 實施修復
5. 驗證修復
6. 文檔與報告

P2漏洞修復流程 (30天內):
1. 列入月度補丁計畫
2. 與其他補丁合併安裝
3. 納入下個維護窗口
4. 實施與驗證
5. 文檔

修復計畫範例:

┌─────────────────────────────────┐
│ 修復計畫 - VUL-01 (RCE漏洞)    │
├─────────────────────────────────┤
│ 漏洞: CVE-2024-1234             │
│ 系統: SQLPROD (SQL Server 2019) │
│ CVSS: 9.8 (致命)               │
│ 優先級: P0 (24小時內)           │
│                                 │
│ 修復方案 (A): 安裝補丁         │
│ ├─ 補丁: KB5034567             │
│ ├─ 大小: 150MB                 │
│ ├─ 下載: 已完成 ✓              │
│ ├─ 停機時間: 15分鐘            │
│ ├─ 回退計畫: 備份已建立 ✓      │
│ └─ 測試環境: 已驗證 ✓          │
│                                 │
│ 修復方案 (B): 臨時隔離         │
│ ├─ 防火牆規則: 已配置          │
│ ├─ 網路隔離: 已執行            │
│ ├─ 驗證: SQL可用性 ✓           │
│ └─ 期限: 24小時內必須補丁     │
│                                 │
│ 實施計畫:                       │
│ ├─ 時間: 2026-02-01 22:00     │
│ ├─ 人員: IT部長李四, 系統管理員 │
│ ├─ 步驟:                        │
│ │   1. 備份SQL資料庫           │
│ │   2. 停止SQL服務             │
│ │   3. 安裝補丁 (15分鐘)      │
│ │   4. 啟動SQL服務             │
│ │   5. 驗證SQL功能             │
│ │   6. 重新掃描驗證            │
│ │                              │
│ ├─ 聯絡人: 技術領隊張三         │
│ ├─ 回退時間: <30分鐘            │
│ └─ 完成時間: 2026-02-01 23:00  │
│                                 │
│ 驗證步驟:                       │
│ ├─ SQL服務運行正常?            │
│ ├─ 資料庫可訪問?                │
│ ├─ 應用連接正常?                │
│ ├─ Nessus掃描: 漏洞已消除?    │
│ └─ 性能無下降?                 │
│                                 │
│ 簽名:                           │
│ ├─ IT部長: 李四 _______        │
│ ├─ CISO: 王五 _______          │
│ └─ 日期: 2026-02-01           │
│                                 │
└─────────────────────────────────┘
```

---

### 模組3.2：修復驗證與報告 (1小時)

```
修復後驗證流程 (Post-Remediation Verification)

修復驗證步驟:

Step 1: 立即功能驗證 (Immediate)
└─ 系統能否啟動?
└─ 應用能否正常運行?
└─ 用戶能否登入?
└─ 網路連接正常?

Step 2: 24小時穩定性驗證
└─ 系統運行24小時無故障?
└─ 性能是否恢復?
└─ 日誌中無異常訊息?

Step 3: 漏洞掃描驗證 (3-5天後)
└─ 重新使用Nessus掃描
└─ 確認漏洞已消除
└─ 記錄驗證結果

修復驗證報告:

┌─────────────────────────────────┐
│ 修復驗證報告                    │
├─────────────────────────────────┤
│ 漏洞: CVE-2024-1234             │
│ 系統: SQLPROD                   │
│ 修復方案: 補丁 KB5034567        │
│ 修復日期: 2026-02-01            │
│                                 │
│ 功能驗證:                       │
│ □ SQL服務正常: ✓                │
│ □ 資料庫訪問: ✓                │
│ □ 應用連接: ✓                  │
│ □ 效能正常: ✓                  │
│ □ 日誌無異常: ✓                │
│                                 │
│ 漏洞掃描驗證:                   │
│ ├─ 掃描日期: 2026-02-04        │
│ ├─ Nessus結果: 漏洞已消除 ✓   │
│ ├─ CVSS變化: 9.8 → 0.0        │
│ └─ 驗證成功 ✓                   │
│                                 │
│ 結論: 修復有效                  │
│ 狀態: RESOLVED ✓                │
│ 簽名: IT部長 李四               │
│ 日期: 2026-02-04               │
│                                 │
└─────────────────────────────────┘

月度漏洞修復報告:

┌──────────────────────────────────┐
│ 2月漏洞修復進度                   │
├──────────────────────────────────┤
│                                  │
│ P0漏洞 (致命):                  │
│ ├─ 發現: 3個                    │
│ ├─ 已修復: 3個 (100%) ✓         │
│ ├─ 待修復: 0個                  │
│ ├─ 平均修復時間: 18小時         │
│ └─ SLA達成: 100% ✓              │
│                                  │
│ P1漏洞 (高):                    │
│ ├─ 發現: 18個                   │
│ ├─ 已修復: 16個 (89%)           │
│ ├─ 待修復: 2個                  │
│ │   └─ 原因: 等待維護窗口       │
│ │   └─ ETA: 2026-02-08         │
│ ├─ 平均修復時間: 5天            │
│ └─ SLA達成: 89% ⚠️              │
│                                  │
│ P2漏洞 (中):                    │
│ ├─ 發現: 52個                   │
│ ├─ 已修復: 25個 (48%)           │
│ ├─ 待修復: 27個                 │
│ │   └─ 預計完成: 2026-03-02   │
│ ├─ 平均修復時間: 12天           │
│ └─ SLA達成: 48% (進行中)       │
│                                  │
│ P3漏洞 (低):                    │
│ ├─ 發現: 83個                   │
│ ├─ 已修復: 0個 (0%)            │
│ ├─ 待修復: 83個                 │
│ │   └─ 預計完成: 2026-04-01   │
│ └─ 作用: 列入下月計畫            │
│                                  │
│ 總體評估:                        │
│ ├─ 發現: 156個漏洞              │
│ ├─ 已修復: 44個 (28%)           │
│ ├─ 修復中: 63個 (40%)           │
│ ├─ 待修復: 49個 (31%)           │
│ ├─ 修復趨勢: ↗️ (持續改善)     │
│ └─ 整體SLA: 92% 達成 ✓          │
│                                  │
│ 風險評估:                        │
│ ├─ 高風險: 0個 (P0已全修) ✓    │
│ ├─ 中高風險: 2個 (P1待修)      │
│ ├─ 總體風險: 降低 ✓             │
│ └─ 推薦: 繼續監視P1進度         │
│                                  │
└──────────────────────────────────┘
```

---

## 第四天：自動化與持續改善
## Day 4: Automation & Continuous Improvement (3 hours)

### 模組4.1：自動化掃描與報告 (2小時)

```
Nessus自動化掃描與報告流程

Nessus API自動化腳本 (Python):

#!/usr/bin/env python3
# Nessus月度掃描與報告自動化

import requests
import json
import schedule
import time
from datetime import datetime

class NessusAutomation:
    def __init__(self, nessus_url, access_key, secret_key):
        self.nessus_url = nessus_url
        self.access_key = access_key
        self.secret_key = secret_key
        self.headers = {
            'X-ApiKeys': f'accessKey={access_key};secretKey={secret_key}',
            'Content-Type': 'application/json'
        }
    
    # 啟動掃描
    def launch_scan(self, template_id, targets):
        scan_data = {
            'uuid': template_id,
            'settings': {
                'name': f'Auto-Scan-{datetime.now().strftime("%Y%m%d")}',
                'text_targets': ','.join(targets),
                'launch_type': 'ON_DEMAND'
            }
        }
        
        response = requests.post(
            f'{self.nessus_url}/scans',
            headers=self.headers,
            json=scan_data,
            verify=False
        )
        
        if response.status_code == 200:
            scan = response.json()
            scan_id = scan['scan']['id']
            print(f'[✓] 掃描已啟動: 掃描ID {scan_id}')
            
            # 啟動掃描
            requests.post(
                f'{self.nessus_url}/scans/{scan_id}/launch',
                headers=self.headers,
                verify=False
            )
            return scan_id
        else:
            print(f'[✗] 掃描啟動失敗: {response.status_code}')
            return None
    
    # 監控掃描進度
    def monitor_scan(self, scan_id, timeout=3600):
        start_time = time.time()
        
        while time.time() - start_time < timeout:
            response = requests.get(
                f'{self.nessus_url}/scans/{scan_id}',
                headers=self.headers,
                verify=False
            )
            
            if response.status_code == 200:
                scan_data = response.json()
                status = scan_data['info']['status']
                progress = scan_data['info']['scan_start']
                
                print(f'[→] 掃描進度: {status} (耗時: {(time.time()-start_time)//60:.0f}分)')
                
                if status == 'completed':
                    print('[✓] 掃描完成!')
                    return True
                
            time.sleep(30)  # 每30秒檢查一次
        
        print('[✗] 掃描超時')
        return False
    
    # 產生報告
    def export_report(self, scan_id, output_file):
        # 要求API匯出報告
        export_data = {'format': 'pdf'}
        response = requests.post(
            f'{self.nessus_url}/scans/{scan_id}/export',
            headers=self.headers,
            json=export_data,
            verify=False
        )
        
        if response.status_code == 200:
            export = response.json()
            export_id = export['export']['token']
            
            # 等待報告準備
            while True:
                status = requests.get(
                    f'{self.nessus_url}/scans/{scan_id}/export/{export_id}/status',
                    headers=self.headers,
                    verify=False
                ).json()
                
                if status['export']['status'] == 'ready':
                    break
                time.sleep(5)
            
            # 下載報告
            report = requests.get(
                f'{self.nessus_url}/scans/{scan_id}/export/{export_id}/download',
                headers=self.headers,
                verify=False
            )
            
            with open(output_file, 'wb') as f:
                f.write(report.content)
            
            print(f'[✓] 報告已下載: {output_file}')
            return True
        
        return False

# 排程設置
def daily_scan():
    """每月第1日自動執行掃描"""
    
    nessus = NessusAutomation(
        nessus_url='https://10.0.1.50:8834',
        access_key='YOUR_API_KEY',
        secret_key='YOUR_SECRET_KEY'
    )
    
    # 掃描配置
    scans = [
        {
            'name': 'Production-Monthly',
            'template': '5',  # Credentialed Patch Audit
            'targets': ['10.0.0.0/24']
        },
        {
            'name': 'Applications-Biweekly',
            'template': '5',
            'targets': ['10.0.1.0/24']
        }
    ]
    
    # 執行掃描
    for scan_config in scans:
        print(f"\n[開始] {scan_config['name']}")
        
        # 啟動掃描
        scan_id = nessus.launch_scan(
            scan_config['template'],
            scan_config['targets']
        )
        
        if scan_id:
            # 監控掃描
            if nessus.monitor_scan(scan_id):
                # 導出報告
                output_file = f"/reports/{scan_config['name']}-{datetime.now().strftime('%Y%m%d')}.pdf"
                nessus.export_report(scan_id, output_file)
                
                # 郵件發送報告
                send_email(
                    to='security@company.com',
                    subject=f'Nessus月度報告: {scan_config["name"]}',
                    body=f'掃描報告已生成，詳見附件',
                    attachment=output_file
                )

# 排程每月1日 03:00 執行
schedule.every().month.do(daily_scan).tag('monthly')
schedule.every().sunday.at('03:00').do(daily_scan).tag('weekly')

# 運行排程
if __name__ == '__main__':
    while True:
        schedule.run_pending()
        time.sleep(60)
```

自動化報告範本:

┌──────────────────────────────────┐
│ Nessus月度漏洞掃描報告            │
│ Nessus Monthly Vulnerability Report
├──────────────────────────────────┤
│                                  │
│ 報告期間: 2026-02-01 ~ 02-28    │
│ 掃描日期: 2026-02-01 03:00      │
│ 掃描範圍: 10.0.0.0/24 (核心系統) │
│ 掃描範本: Credentialed Patch     │
│ 掃描耗時: 1.58小時               │
│                                  │
│ 漏洞統計:                        │
│ ├─ 總漏洞: 156個                │
│ ├─ P0 (致命): 3個 (1.9%)       │
│ ├─ P1 (高): 18個 (11.5%)       │
│ ├─ P2 (中): 52個 (33.3%)       │
│ └─ P3 (低): 83個 (53.2%)       │
│                                  │
│ 月度變化:                        │
│ ├─ 新增漏洞: 24個               │
│ ├─ 已修復: 12個                 │
│ ├─ 持續監視: 120個              │
│ └─ 趨勢: ↗️ 上升 (新增>修復)   │
│                                  │
│ 主要風險:                        │
│ ├─ RCE漏洞 (SQLPROD): P0       │
│ ├─ 認證繞過 (12伺服器): P1      │
│ └─ 弱加密配置 (多系統): P2      │
│                                  │
│ 建議行動:                        │
│ ├─ 立即: 修復3個P0漏洞 (<24h)  │
│ ├─ 本週: 修復18個P1漏洞 (<7d)  │
│ └─ 本月: 修復52個P2漏洞 (<30d) │
│                                  │
│ 詳細掃描結果見附件PDF報告         │
│                                  │
└──────────────────────────────────┘
```

---

### 模組4.2：ISO 27001 A12.6.1合規與持續改善 (1小時)

```
ISO 27001 A12 - 安全組態管理與系統硬化

A12.6.1 - 管理技術漏洞 (Management of Technical Vulnerabilities)

要求:
└─ 組織應及時掌握系統漏洞信息
└─ 建立評估暴露風險的流程
└─ 確定優先級與修復時間
└─ 保存所有記錄

本公司合規措施:

✅ 漏洞識別 (Identification):
├─ 工具: Nessus Professional
├─ 頻率: 月度自動掃描 (核心系統)
├─ 頻率: 雙週掃描 (應用系統)
├─ 範圍: 100% IT資產覆蓋
└─ 紀錄: 完整保存 (2年)

✅ 漏洞評估 (Assessment):
├─ 方法: CVSS評分 (3.1版本)
├─ 優先級: P0-P3 + 環境因素調整
├─ 業務影響: 納入評估
├─ 決策: IT部長 + CISO核批
└─ 紀錄: 優先級決策表

✅ 修復管理 (Remediation):
├─ P0 (致命): <24小時
├─ P1 (高): <7天
├─ P2 (中): <30天
├─ P3 (低): <60天
├─ 彙整: 與補丁管理流程整合
└─ 紀錄: 修復計畫與驗證報告

✅ 驗證與監督 (Verification):
├─ 修復後驗證: 重新掃描 (3-5天)
├─ 修復率監視: 月度報告
├─ SLA合規: 追蹤達成率
├─ 趨勢分析: 漏洞數量變化
└─ 紀錄: 漏洞追蹤表 + 驗證報告

漏洞記錄保存 (3年):

┌─────────────────────────────────┐
│ 漏洞紀錄檔案結構                │
├─────────────────────────────────┤
│ /Vulnerability-Records/         │
│ ├─ 2024/                        │
│ │   ├─ 2024-01-Nessus-Report   │
│ │   ├─ 2024-02-Nessus-Report   │
│ │   └─ ...                     │
│ ├─ 2025/                        │
│ │   └─ ...                      │
│ ├─ 2026/                        │
│ │   ├─ 2026-02-Nessus-Report   │
│ │   ├─ Vulnerability-Tracking   │
│ │   ├─ Remediation-Plans        │
│ │   └─ Verification-Reports     │
│ │                               │
│ └─ 保留期限: 3年 (法律要求)    │
│    └─ 歸檔: 後年度移至冷存儲  │
│                                 │
└─────────────────────────────────┘

年度改善計畫:

2026年目標:
├─ 漏洞檢測時間: 維持 <1個月
├─ 修復完成率: 從現在62% → 目標85%
├─ P0漏洞修復: 100% <24小時
├─ P1漏洞修復: 100% <7天
├─ P2漏洞修復: 80% <30天
└─ 整體漏洞趨勢: 年度下降 >20%

改善行動項:

┌──────────────────────────────────┐
│ 編號 │ 改善項      │ 期限       │
├──────────────────────────────────┤
│ IM-1 │ 增加Nessus │ 2026-03-31 │
│      │ 掃描頻率   │            │
│      │ (月→雙週) │            │
├──────────────────────────────────┤
│ IM-2 │ 建立補丁   │ 2026-02-28 │
│      │ 自動化工具 │            │
│      │ (減少手動) │            │
├──────────────────────────────────┤
│ IM-3 │ 員工培訓   │ 2026-03-15 │
│      │ 漏洞認知   │            │
│      │ (內部報告) │            │
├──────────────────────────────────┤
│ IM-4 │ 建立漏洞   │ 2026-04-30 │
│      │ 回報機制   │            │
│      │ (員工舉報) │            │
└──────────────────────────────────┘

稽核就緒檢查清單:

ISO 27001認證稽核時:
□ 展示Nessus掃描配置與排程
□ 展示2025-2026年所有掃描報告 (24份)
□ 展示漏洞優先級化規則與決策樹
□ 展示漏洞修復計畫與驗證報告
□ 展示修復時間與SLA達成率
□ 展示月度漏洞狀態報告
□ 展示員工培訓紀錄
□ 展示改善項追蹤與實施
□ 展示3年漏洞紀錄檔案
□ 顯示無未修復的P0漏洞

稽核預期結果: 符合 (No findings) ✅
```

---

## 課程總結與評估

```
✅ 知識目標達成:

□ 理解漏洞管理五階段生命週期
□ 掌握CVSS評分與優先級化方法
□ 掌握本公司漏洞優先級化規則
□ 理解Nessus掃描配置與執行
□ 掌握漏洞追蹤與修復流程
□ 理解修復驗證與報告
□ 理解自動化掃描與報告
□ 理解ISO 27001 A12.6.1合規要求

✅ 操作能力達成:

□ 能配置與執行Nessus掃描
□ 能分析掃描結果與識別漏洞
□ 能應用CVSS評分評估風險
□ 能制定漏洞修復計畫
□ 能執行修復驗證
□ 能監控修復進度與SLA
□ 能生成漏洞報告
□ 能實施自動化掃描與報告

✅ 合規能力達成:

□ ISO 27001 A12.6.1 漏洞管理
□ A12.6.1 漏洞評估流程
□ A12.6.1 優先級化與修復
□ A12.6.1 記錄與證據保存
□ 完整的3年稽核記錄

成功指標:

├─ 月度漏洞掃描: ✅ (100% 執行)
├─ 漏洞檢測準確性: ✅ (高可信度)
├─ 修復完成率: 62% → 目標85%
├─ P0漏洞修復SLA: ✅ (100% <24h)
├─ P1漏洞修復SLA: 89% → 目標100%
├─ 報告自動化: ✅ (月度自動)
├─ 稽核紀錄: ✅ (完整3年)
└─ 員工培訓: ✅ (100% 完成)
```

---

**文檔版本控制與簽批**：

| 版本 | 日期 | 內容 | 審批人 |
|------|------|------|--------|
| v1.0 | 2026-02-12 | 初版，漏洞管理完整待辦清單 | CISO |

---

**EOF - 弱點管理與漏洞掃描待辦清單完成** ✅

恭喜！您已掌握完整的漏洞管理與Nessus掃描能力。
準備好進行持續的安全改善！
